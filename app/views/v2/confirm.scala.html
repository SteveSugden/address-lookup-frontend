@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import model._
@import utils.IsCountryUK
@import templates.address_confirmation_display
@import uk.gov.hmrc.play.views.html.helpers
@import views.html.v2.main_template
@import model.MessageConstants.{EnglishMessageConstants, WelshMessageConstants, MessageConstants}

@import config.FrontendAppConfig
@(appConfig: FrontendAppConfig, id: String, journeyData: JourneyDataV2, selectedAddress: Option[ConfirmableAddress], isWelsh: Boolean = false, isUkMode: Boolean = true)(implicit request: Request[_], messages: Messages)

@messageConstants = @{if(isWelsh) WelshMessageConstants(isUkMode) else EnglishMessageConstants(isUkMode)}

@main_template(appConfig, title = journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.title, journeyData = Some(journeyData), welshEnabled = isWelsh) {

  @if(journeyData.config.options.showBackButtons.getOrElse(true)) {
    <div>
      <a class="back-link" href="javascript:history.back()">@{messageConstants.back}</a>
    </div>
  }

  <header class="page-header">
    <h1 class="heading-xlarge" id="pageHeading">@{journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.heading}</h1>
  </header>

  @if(selectedAddress.isDefined) {
    @helpers.form(controllers.routes.AddressLookupController.handleConfirm(id)) {
      <fieldset class="form-field-group">
        <div class="form-field">
          @if(journeyData.resolveConfigV2(isWelsh).options.confirmPageConfig.showSubHeadingAndInfo) {
            <h2>@{journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.infoSubheading}</h2>
            <p id="infoMessage">@Html(journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.infoMessage)</p>
          }
          @address_confirmation_display(selectedAddress.get.address)
        </div>
        @if(journeyData.resolveConfigV2(isWelsh).options.confirmPageConfig.showSearchAgainLink) {
          <div class="form-field">
            <p><a href="@{routes.AddressLookupController.lookup(id)}" id="searchAgainLink">@{journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.searchAgainLinkText}</a></p>
          </div>
        }
        @if(journeyData.resolveConfigV2(isWelsh).options.confirmPageConfig.showChangeLink) {
        <div class="form-field">
          <p><a href="@{routes.AddressLookupController.edit(id,None,Some(IsCountryUK.countryCheck(selectedAddress)))}" id="changeLink">@{journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.changeLinkText}</a></p>
        </div>
        }
        @if(journeyData.resolveConfigV2(isWelsh).options.confirmPageConfig.showConfirmChangeText){
        <div class="form-field">
          <p id="confirmChangeText">@journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.confirmChangeText</p>
        </div>
        }
        <div class="form-field">
          <button class="button" type="submit" id="continue">@{journeyData.resolveConfigV2(isWelsh).labels.confirmPageLabels.submitLabel}</button>
        </div>
      </fieldset>
    }
  } else {
    <p>@{messageConstants.confirmSelectedAddressError1} <a href="@{routes.AddressLookupController.lookup(id)}" id="lookupLink">@{messageConstants.confirmSelectedAddressError2}</a>.</p>
  }
}
<!--TODO: Remove unreachable redirect to the lookup page-->